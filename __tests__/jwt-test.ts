import * as JWT from '../src/jwt';

describe('jwt', () => {
  const jwt =
    'eyJhbGciOiJFUzI1NksiLCJ0eXAiOiJKV1QiLCJraWQiOiJkaWQ6d2ViOmFzc2V0cy1kYXRhc2lnbi5zMy1hcC1ub3J0aGVhc3QtMS5hbWF6b25hd3MuY29tOnNpb3AtdGVzdDpycCNjb250cm9sbGVyIn0.eyJpc3MiOiJkaWQ6d2ViOmFzc2V0cy1kYXRhc2lnbi5zMy1hcC1ub3J0aGVhc3QtMS5hbWF6b25hd3MuY29tOnNpb3AtdGVzdDpycCIsInJlc3BvbnNlX3R5cGUiOiJpZF90b2tlbiIsInNjb3BlIjoib3BlbmlkIGRpZF9hdXRobiIsImNsaWVudF9pZCI6Imh0dHA6Ly8xOTIuMTY4LjEwMC4xMzQ6NTAwMS92YWxpZGF0ZSIsInJlZ2lzdHJhdGlvbiI6eyJhdXRob3JpemF0aW9uX2VuZHBvaW50Ijoib3BlbmlkOiIsImlzc3VlciI6Imh0dHBzOi8vc2VsZi1pc3N1ZWQubWUvdjIiLCJyZXNwb25zZV90eXBlc19zdXBwb3J0ZWQiOlsiaWRfdG9rZW4iXSwic2NvcGVzX3N1cHBvcnRlZCI6WyJvcGVuaWQiXSwiY3JlZGVudGlhbF9mb3JtYXRzX3N1cHBvcnRlZCI6WyJqd3RfdmMiXSwic3ViamVjdF90eXBlc19zdXBwb3J0ZWQiOlsicGFpcndpc2UiXSwic3ViamVjdF9pZGVudGlmaWVyX3R5cGVzX3N1cHBvcnRlZCI6WyJkaWQ6d2ViOiJdLCJpZF90b2tlbl9zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkIjpbIkVTMjU2SyJdLCJyZXF1ZXN0X29iamVjdF9zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkIjpbIkVTMjU2SyJdLCJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly8xOTIuMTY4LjEwMC4xMzQ6NTAwMS92YWxpZGF0ZSJdLCJqd2tzX3VyaSI6Imh0dHBzOi8vdW5pcmVzb2x2ZXIuaW8vMS4wL2lkZW50aWZpZXJzL2RpZDp3ZWI6YXNzZXRzLWRhdGFzaWduLnMzLWFwLW5vcnRoZWFzdC0xLmFtYXpvbmF3cy5jb206c2lvcC10ZXN0OnJwO3RyYW5zZm9ybS1rZXlzPWp3a3MiLCJkaWQiOiJkaWQ6d2ViOmFzc2V0cy1kYXRhc2lnbi5zMy1hcC1ub3J0aGVhc3QtMS5hbWF6b25hd3MuY29tOnNpb3AtdGVzdDpycCJ9LCJyZWRpcmVjdF91cmkiOiJodHRwOi8vMTkyLjE2OC4xMDAuMTM0OjUwMDEvdmFsaWRhdGUiLCJraWQiOiJkaWQ6d2ViOmFzc2V0cy1kYXRhc2lnbi5zMy1hcC1ub3J0aGVhc3QtMS5hbWF6b25hd3MuY29tOnNpb3AtdGVzdDpycCNjb250cm9sbGVyIn0.FTNeXX12DwldwFjJ5iH1Lkv9dd0zk8g5kd0qUa3dFBZ4b7fGI_8uwKYrG1qcycmQBfWdKdkP61C4pkIU5WxlKw';
  test('verify', async () => {
    await JWT.verifyJWT(jwt);
  });

  test('JWK thumbprint', () => {
    const minimalJwk = {
      kty: 'EC',
      crv: 'K-256',
      x: 'rT61nvuz2LCRzx4W1EfEwGAiVgCuN6aKTW-PZ46qD1E',
      y: 'ABGl1Pr6v7nVwvaa1g14m5M7oGgqs23Fpf780x-VJpM',
    };
    expect(JWT.calculateJWKThumprint(minimalJwk)).toBe(
      'UCKoaM6I76JIu46bGUaCfMSnQwMUIuKmoRF0bnYzLd4',
    );
  });
});
